---
k3s_version: v1.22.4+k3s1
ansible_user: debian
systemd_dir: /etc/systemd/system

# This token is used to secure communication between nodes.
#
k3s_token: "MySuperSecureServerToken"

extra_server_args: ""
extra_agent_args: ""

# High-availability using an embedded DB is an option as of v1.19.5+k3s1.
# (See https://rancher.com/docs/k3s/latest/en/installation/ha-embedded/.)
# To enable HA, set ha_enabled to true.  Other options, external to the cluster,
# are also available but not implemented here.  Note: there must be at least
# three server nodes in your cluster to use an embedded DB.
#
ha_enabled: false

# When using HA, a cluster VIP should be in front of the control-plane servers
# for agent configuration as well as cluster definition in # .kube/config.  Set
# ha_lb_vip to the IP address for your cluster VIP.  Note: This is an IP address
# different than the cluster nodes.  Today, this is a static IP provided in this
# file.  It is possible to get an IP dynamically but not implemented here (yet).
# 
ha_lb_vip: 192.168.1.254

# When using HA, a method must be chosen to manage the cluster VIP.  The methods
# implemented today are:
#   1) external - requires a load-balancer external to the cluster
#   2) kube-vip - https//kube-vip.io, arp-based daemonset using leader election
#
# Other load-balancing options are available (e.g., keepalived) but are not
# implemented here (yet).  ha_lb_version specifies the version of the method to
# be used.
#
ha_lb_method: kube-vip
ha_lb_version: v0.4.0


###################################
# Don't change variables below here
# TODO: Move these to a different file
#
first_server: "{{ hostvars[groups['server'][0]]['ansible_host'] | default(groups['server'][0]) }}"

apiserver_endpoint: "{{ ha_lb_vip if ha_enabled else first_server }}"

